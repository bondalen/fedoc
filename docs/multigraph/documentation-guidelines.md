# Правила ведения документации multigraph

Документ описывает правила работы с содержимым каталога `docs/multigraph/`. При любом изменении файлов этой папки следует руководствоваться указанными здесь требованиями.

## 1. Общие принципы

1.1. Документация организуется по назначению:  
- `aa-main-docs/` — основная (стратегическая) проектная документация;  
- `bb-chats/` — резюме чатов, отражающие ход работы;  
- `cc-preliminary/` — рабочие материалы, черновики, детальные отчёты.

1.2. Файлы в корне `docs/multigraph/` содержат глобальные артефакты: текущий документ правил, обзорные материалы (при необходимости).

1.3. Для именования файлов и папок используйте префиксы `aa-`, `bb-`, `cc-` для поддержания алфавитной группировки по важности.

1.4. Все относительные ссылки формируем относительно документа, в котором они размещаются. Абсолютные пути не используются.

## 2. Резюме чатов (`bb-chats/`)

2.1. Формат имени: `chat-YYMMDD-resume-HH-MM.md` (дата и время окончания сессии).  
2.2. Структура резюме должна включать:
- Контекст и цели сессии;  
- Перечень выполненных действий;  
- Ссылки на созданные/изменённые документы;  
- Следующие шаги (hand-off);  
- Статус на момент завершения.

2.3. Любая задача, описанная в `aa-main-docs/bb-tasks.md`, после выполнения должна получать ссылку на соответствующее резюме чата (см. п. 4.2).

## 3. Основная документация (`aa-main-docs/`)

3.1. Документы должны содержать:
- Метаданные (версия, дата, статус, автор);  
- Чёткую структуру разделов;  
- Ссылки на подтверждающие материалы в `cc-preliminary/` и `bb-chats/`.

3.2. В файле `aa-project.md` фиксируются ключевые решения. При появлении проверяющих тестов или отчётов необходимо ссылаться на соответствующие документы (например, `psycopg2-shiv-test.md`).

3.3. Файл `bb-tasks.md` используется как иерархический перечень задач. Для каждой задачи:
- Используем структуру нумерации `X.Y.Z`;  
- Под поддержанием ссылки на резюме чата, где задача закрыта;  
- При отсутствии ссылки оставляем пометку `*(нет)*`.

3.4. Для `aa-main-docs/mc-components.md`:
- указываем путь в файловой системе в строке с префиксом `ФС:`;
- цветовое выделение задаётся средствами редактора (дополнительные HTML-теги не используем);
- вложенные элементы, лежащие в том же каталоге/файле, путь не дублируют — он фиксируется только на ближайшем вышестоящем артефакте.

## 4. Рабочие материалы (`cc-preliminary/`)

4.1. Папки именуются по дате `YY-MMDD`, внутри хранится подробная документация (анализы, тесты, черновики).  
4.2. Каждый документ должен содержать:
- Заголовок с описанием и датой;  
- Цель/контекст;  
- Ход работы (шаги);  
- Итоги и выводы;  
- Ссылки на связанные файлы (например, резюме чата).

4.3. После завершения работы по теме в `bb-chats` добавляется ссылка на документ из `cc-preliminary`.

## 5. Перемещение и переименование

5.1. При переносе файла в другую папку необходимо обновить все относительные ссылки в остальных документах.  
5.2. После перемещения обязательно проверить резюме чатов, чтобы ссылки оставались рабочими.  
5.3. Если ссылка используется в нескольких файлах, рекомендуется воспользоваться `rg`/`grep` для поиска и массового обновления.

## 6. Новые документы

6.1. Перед созданием нового файла убедитесь, что он помещается в правильный раздел (`aa-`, `bb-`, `cc-`).  
6.2. Обязательные элементы:
- Заголовок (h1);  
- Метаданные (дата, цель/статус);  
- Содержательная структура соответствующая типу документа.  
6.3. После добавления нового документа:
- Сослаться на него в релевантных резюме чатов;  
- При необходимости — внести краткое упоминание в `aa-project.md` или другие обзорные файлы.

## 7. Правки и подтверждение изменений

7.1. Все значимые изменения (архитектурные выводы, тесты, решения) фиксируются в `bb-chats` и при необходимости отражаются в `aa-main-docs`.  
7.2. Если изменение сопровождается тестом, документируйте его в `cc-preliminary` и связывайте ссылки во всех затронутых файлах.

## 8. Версионность и синхронизация

8.1. Перед коммитом проверяйте структуру ссылок: `rg "..\/bb-chats" docs/multigraph`.  
8.2. После синхронизации (`git push`) убедитесь, что все новые документы присутствуют в удалённом репозитории.

---

**Последнее обновление правил:** 2025-11-08  
**Ответственный за актуальность:** Александр
