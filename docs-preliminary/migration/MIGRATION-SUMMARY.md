# –ú–∏–≥—Ä–∞—Ü–∏—è fedoc —Å ArangoDB –Ω–∞ PostgreSQL + Apache AGE

**–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:** 18 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏–∏:**
- PostgreSQL: 16.10
- Apache AGE: 1.6.0
- –°–µ—Ä–≤–µ—Ä: 176.108.244.252 (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä fedoc-postgres)

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π (completed ‚úÖ)

### PostgreSQL 16.10
```
PostgreSQL 16.10 on x86_64-pc-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit
```

### Apache AGE 1.6.0
```
 name | default_version | installed_version |        comment         
------+-----------------+-------------------+------------------------
 age  | 1.6.0           | 1.6.0             | AGE database extension
```

**–í—ã–≤–æ–¥:** –í–µ—Ä—Å–∏–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ! ‚úÖ

---

## üéØ –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ArangoDB

### –ö–æ–ª–ª–µ–∫—Ü–∏–∏ (Collections)

**Document Collections:**
1. `canonical_nodes` - –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ —É–∑–ª—ã (–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
2. `projects` - –ø—Ä–æ–µ–∫—Ç—ã (fedoc, fepro, femsq)

**Edge Collections:**
1. `project_relations` - —Å–≤—è–∑–∏ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ –≥—Ä–∞—Ñ–∞

**Named Graphs:**
1. `common_project_graph` - –æ–±—â–∏–π –≥—Ä–∞—Ñ –ø—Ä–æ–µ–∫—Ç–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

**canonical_nodes:**
```json
{
  "_key": "c:backend",
  "_id": "canonical_nodes/c:backend",
  "name": "Backend",
  "kind": "concept"
}
```

**project_relations:**
```json
{
  "_from": "canonical_nodes/c:project",
  "_to": "canonical_nodes/c:dev-objects",
  "relationType": "contains",
  "projects": ["fepro", "femsq", "fedoc"],
  "weight": 3
}
```

---

## üîÑ –¢–µ–∫—É—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã AQL

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∑–ª–æ–≤ (—Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ –ø—Ä–æ–µ–∫—Ç—É)
```aql
LET verts = (
  FOR e IN project_relations 
  FILTER @project IN e.projects 
  RETURN [e._from, e._to]
)
LET flattened = FLATTEN(verts)
LET unique_verts = UNIQUE(flattened)
FOR vid IN unique_verts
  LET d = DOCUMENT(vid)
  FILTER d != null
  RETURN { _id: d._id, _key: d._key, name: d.name }
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ (–æ–±—Ö–æ–¥)
```aql
FOR v, e IN 1..@depth OUTBOUND @start_node GRAPH @graph
    LIMIT @max_nodes
    RETURN {
        edge_id: e._id,
        from: e._from,
        to: e._to,
        from_name: DOCUMENT(e._from).name,
        to_name: DOCUMENT(e._to).name,
        projects: e.projects,
        type: e.relationType
    }
```

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —É–∑–ª–∞ (expand_node)
```aql
FOR v, e IN 1..1 OUTBOUND @node GRAPH @graph
    RETURN {
        node: v,
        edge: e
    }
```

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–≥—Ä–∞—Ñ–∞ (subgraph)
```aql
FOR v, e, p IN 1..@depth OUTBOUND @node GRAPH @graph
    RETURN {
        node_id: v._id,
        edge_id: e._id,
        edge_projects: e.projects
    }
```

### 5. –í–∞–ª–∏–¥–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–±—Ä–∞
```aql
FOR e IN project_relations
    FILTER (e._from == @from AND e._to == @to) 
        OR (e._from == @to AND e._to == @from)
    FILTER e._id != @exclude_id
    LIMIT 1 
    RETURN {_id: e._id, _from: e._from, _to: e._to}
```

---

## üéØ –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

–°–æ–≥–ª–∞—Å–Ω–æ `docs-preliminary/analysis/FINAL-RECOMMENDATION.md`:

‚úÖ **PostgreSQL –ø–æ–∑–≤–æ–ª—è–µ—Ç** —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç ArangoDB CE)  
‚úÖ **–§—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç** —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –≤ –ë–î  
‚úÖ **–≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (1 –≤—ã–∑–æ–≤ –≤–º–µ—Å—Ç–æ 2)  
‚úÖ **–î–∞–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å** (–ø—Ä–æ–≤–µ—Ä–∫–∞ + —Å–æ–∑–¥–∞–Ω–∏–µ –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)  
‚úÖ **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ:** –•—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å cypher()

---

## üìã –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ‚è≥
- [ ] –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö `fedoc`
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ Apache AGE
- [ ] –°–æ–∑–¥–∞—Ç—å –≥—Ä–∞—Ñ `common_project_graph`
- [ ] –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–µ—Ä—à–∏–Ω –∏ —Ä—ë–±–µ—Ä

### –≠—Ç–∞–ø 2: –§—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ‚è≥
- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä—ë–±–µ—Ä
- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–±—Ä–∞
- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–±—Ä–∞
- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —É–¥–∞–ª–µ–Ω–∏—è —Ä–µ–±—Ä–∞

### –≠—Ç–∞–ø 3: –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚è≥
- [ ] –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ ArangoDB
- [ ] –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —É–∑–ª–æ–≤
- [ ] –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Ä—ë–±–µ—Ä
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –≠—Ç–∞–ø 4: –ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ ‚è≥
- [ ] AQL ‚Üí Cypher: –ø–æ–ª—É—á–µ–Ω–∏–µ —É–∑–ª–æ–≤
- [ ] AQL ‚Üí Cypher: –æ–±—Ö–æ–¥ –≥—Ä–∞—Ñ–∞
- [ ] AQL ‚Üí Cypher: —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —É–∑–ª–∞
- [ ] AQL ‚Üí Cypher: –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–≥—Ä–∞—Ñ–∞

### –≠—Ç–∞–ø 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ ‚è≥
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å python-arango –Ω–∞ psycopg2 + AGE
- [ ] –û–±–Ω–æ–≤–∏—Ç—å api_server.py
- [ ] –û–±–Ω–æ–≤–∏—Ç—å edge_validator.py
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

### –≠—Ç–∞–ø 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚è≥
- [ ] –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- [ ] –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è —Ä—ë–±–µ—Ä
- [ ] –¢–µ—Å—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≥—Ä–∞—Ñ–∞
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

---

**–°—Ç–∞—Ç—É—Å:** –í –ø—Ä–æ—Ü–µ—Å—Å–µ  
**–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø:** –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã

