# –ê–Ω–∞–ª–∏–∑ –ø–æ–¥—Ö–æ–¥–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–º –¥–ª—è —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ Apache AGE

**–î–∞—Ç–∞:** 17 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–æ–ø—Ä–æ—Å:** –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ Apache AGE?  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω

---

## üí° –°—É—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–í–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞ Cypher –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```python
# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é
cypher("CREATE (a)-[r]->(b)")  # –¢—Ä–∏–≥–≥–µ—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É:
```python
# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
INSERT INTO edge_requests (from_id, to_id, label)
VALUES (node_a_id, node_b_id, 'RELATED');

# –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ edge_requests ‚Üí –í–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí Cypher CREATE
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ INSERT
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  edge_requests (—Ç–∞–±–ª–∏—Ü–∞)    ‚îÇ
‚îÇ  - from_id                  ‚îÇ
‚îÇ  - to_id                    ‚îÇ
‚îÇ  - label                    ‚îÇ
‚îÇ  - processed                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ TRIGGER (BEFORE INSERT)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –§—É–Ω–∫—Ü–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–∞:          ‚îÇ
‚îÇ  1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤     ‚îÇ
‚îÇ  2. –í—ã–∑–æ–≤ Cypher CREATE     ‚îÇ
‚îÇ  3. –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ processed    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  AGE Graph (—Ä–µ–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –¢—Ä–∏–≥–≥–µ—Ä + Cypher

```sql
CREATE OR REPLACE FUNCTION process_edge_via_trigger()
RETURNS TRIGGER AS $$
DECLARE
    dup_count INTEGER;
BEGIN
    -- 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
    SELECT COUNT(*) INTO dup_count
    FROM my_graph._ag_label_edge
    WHERE (start_id = NEW.from_id AND end_id = NEW.to_id)
       OR (start_id = NEW.to_id AND end_id = NEW.from_id);
    
    IF dup_count > 0 THEN
        RAISE EXCEPTION 'Duplicate edge detected';
    END IF;
    
    -- 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–±—Ä–∞ —á–µ—Ä–µ–∑ Cypher
    -- –ü–†–û–ë–õ–ï–ú–ê: –ù–ï –†–ê–ë–û–¢–ê–ï–¢!
    PERFORM cypher('my_graph', format($$
        MATCH (a) WHERE id(a) = %s 
        MATCH (b) WHERE id(b) = %s
        CREATE (a)-[r:%s]->(b)
        RETURN r
    $$, NEW.from_id, NEW.to_id, NEW.label));
    
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

**–ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ1:** ‚ùå **`cypher()` –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ PL/pgSQL —Ç—Ä–∏–≥–≥–µ—Ä–∞**
- Cypher - —ç—Ç–æ SQL —Ñ—É–Ω–∫—Ü–∏—è, –Ω–æ –µ—ë –≤—ã–∑–æ–≤ –∏–∑ —Ç—Ä–∏–≥–≥–µ—Ä–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- PERFORM –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö –Ω–∞–±–æ—Ä—ã –∑–∞–ø–∏—Å–µ–π

### –í–∞—Ä–∏–∞–Ω—Ç 2: –¢—Ä–∏–≥–≥–µ—Ä + –ø—Ä—è–º–∞—è –≤—Å—Ç–∞–≤–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü—É

```sql
CREATE OR REPLACE FUNCTION process_edge_direct()
RETURNS TRIGGER AS $$
BEGIN
    -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
    -- ... (–∫–∞–∫ –≤—ã—à–µ)
    
    -- –ü—Ä—è–º–∞—è –≤—Å—Ç–∞–≤–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü—É —Ä—ë–±–µ—Ä AGE
    INSERT INTO my_graph._ag_label_edge (id, start_id, end_id, properties)
    VALUES (
        nextval('my_graph."RELATED_id_seq"'),
        NEW.from_id,
        NEW.to_id,
        NEW.properties::agtype
    );
    
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

**–ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ2:** ‚ùå **–û–±—Ö–æ–¥ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ª–æ–≥–∏–∫–∏ AGE**
- AGE –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è ID
- –ù—É–∂–Ω–æ –∑–Ω–∞—Ç—å —Ç–æ—á–Ω—É—é —Å—Ö–µ–º—É —Ç–∞–±–ª–∏—Ü AGE
- –ú–æ–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏–Ω–¥–µ–∫—Å—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã AGE
- –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –±—É–¥—É—â–∏–º–∏ –≤–µ—Ä—Å–∏—è–º–∏

### –í–∞—Ä–∏–∞–Ω—Ç 3: –¢—Ä–∏–≥–≥–µ—Ä + —Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

```sql
-- –¢—Ä–∏–≥–≥–µ—Ä —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç
CREATE OR REPLACE FUNCTION validate_edge_request()
RETURNS TRIGGER AS $$
BEGIN
    -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
    -- ...
    
    -- –¢–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ë–ï–ó —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–±—Ä–∞
    NEW.checked := TRUE;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Ç–æ–º —á–∏—Ç–∞–µ—Ç edge_requests –∏ —Å–æ–∑–¥–∞–µ—Ç —á–µ—Ä–µ–∑ Cypher
```

**–ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ3:** ‚ö†Ô∏è **–î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å**
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ INSERT ‚Üí edge_requests
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ SELECT ‚Üí –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Cypher CREATE ‚Üí —Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ
- –≠—Ç–æ —Å–ª–æ–∂–Ω–µ–µ, —á–µ–º –ø—Ä—è–º–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏!

---

## üìä –ê–Ω–∞–ª–∏–∑ –ø–æ–¥—Ö–æ–¥–∞

### ‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

1. **–¢—Ä–∏–≥–≥–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î
2. **–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤** - —Ç–∞–±–ª–∏—Ü–∞ edge_requests —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏
3. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
4. **–ê—É–¥–∏—Ç** - –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–ª —Å–≤—è–∑–∏

### ‚ùå **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**

1. **–ù–ï –†–ê–ë–û–¢–ê–ï–¢ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Cypher** –∏–∑ —Ç—Ä–∏–≥–≥–µ—Ä–∞
   - PL/pgSQL –Ω–µ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å cypher() –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - –ù—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

2. **–£—Å–ª–æ–∂–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
   ```
   –ü—Ä–æ—Å—Ç–æ–µ (—Ç–µ–∫—É—â–µ–µ):
   –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí –í–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí ArangoDB
   
   –°–ª–æ–∂–Ω–æ–µ (—Å –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–º):
   –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí –¢–∞–±–ª–∏—Ü–∞ ‚Üí –¢—Ä–∏–≥–≥–µ—Ä ‚Üí –í–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí ???
                                                  ‚Üì
   –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí –ß—Ç–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã ‚Üí Cypher CREATE ‚Üí AGE Graph
   ```

3. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
   - –î–∞–Ω–Ω—ã–µ –≤ edge_requests
   - –î–∞–Ω–Ω—ã–µ –≤ –≥—Ä–∞—Ñ–µ AGE
   - –ù—É–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

4. **–ü—Ä–æ–±–ª–µ–º—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏:**
   - –ï—Å–ª–∏ Cypher CREATE —É–ø–∞–¥–µ—Ç, –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –≤ edge_requests
   - –ù—É–∂–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç–∫–∞—Ç–∞

5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - –î–≤–µ –∑–∞–ø–∏—Å–∏ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–π (edge_requests + –≥—Ä–∞—Ñ)
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ SELECT –¥–ª—è —á—Ç–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã

6. **–ù–µ –ø—Ä–æ—â–µ, —á–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏!**
   ```python
   # –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ (—Ç–µ–∫—É—â–∞—è):
   if check_uniqueness(from, to):
       create_edge(from, to)  # 2 —à–∞–≥–∞
   
   # –° —Ç–∞–±–ª–∏—Ü–µ–π-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–º:
   insert_request(from, to)   # 1. –í—Å—Ç–∞–≤–∫–∞ –≤ edge_requests
   requests = select_unchecked()  # 2. –ß—Ç–µ–Ω–∏–µ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö
   for req in requests:
       create_edge(req.from, req.to)  # 3. –°–æ–∑–¥–∞–Ω–∏–µ –≤ –≥—Ä–∞—Ñ–µ
   # 3+ —à–∞–≥–∞!
   ```

---

## üéØ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –¢–µ–∫—É—â–µ–µ (App Validation) | –¢–∞–±–ª–∏—Ü–∞-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫ |
|----------|-------------------------|-------------------|
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** | ‚≠ê –ü—Ä–æ—Å—Ç–∞—è | ‚≠ê‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–∞—è |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –ë—ã—Å—Ç—Ä–æ | ‚≠ê‚≠ê‚≠ê –ú–µ–¥–ª–µ–Ω–Ω–æ (2 –∑–∞–ø–∏—Å–∏) |
| **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ | ‚≠ê‚≠ê –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ |
| **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –ü—Ä–æ—Å—Ç–æ | ‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ |
| **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** | ‚úÖ –ù–µ—Ç | ‚ùå –î–∞ |
| **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏** | ‚ö†Ô∏è –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ | ‚úÖ –í –ë–î |
| **–ê—É–¥–∏—Ç** | ‚ö†Ô∏è –ù—É–∂–µ–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ | ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π |
| **–†–∞–±–æ—Ç–∞ —Å AGE** | ‚úÖ –ù–∞—Ç–∏–≤–Ω–∞—è | ‚ö†Ô∏è –ß–µ—Ä–µ–∑ –∫–æ—Å—Ç—ã–ª–∏ |

---

## üí° –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥

### **–ï—Å–ª–∏ –æ—á–µ–Ω—å —Ö–æ—á–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫:**

#### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ "–æ—á–µ—Ä–µ–¥—å + –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä":**

```python
# 1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å
app.insert_edge_request(from_id, to_id, label)
    ‚Üì
# 2. –¢—Ä–∏–≥–≥–µ—Ä –¢–û–õ–¨–ö–û –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç
TRIGGER: check_uniqueness() ‚Üí OK/FAIL
    ‚Üì
# 3. –§–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —á–∏—Ç–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å
processor.process_pending_requests()
    for request in pending:
        cypher_create_edge(request)
        mark_as_processed(request)
```

**–ù–æ —ç—Ç–æ —Å–ª–æ–∂–Ω–µ–µ –∏ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º:**

```python
# –¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ
if validator.check_uniqueness(from, to):
    db.cypher_create_edge(from, to)
```

---

## üìä –†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### –¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ (–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏):

```python
# –û–¥–∏–Ω –º–µ—Ç–æ–¥ API
@app.route('/api/edges', methods=['POST'])
def create_edge():
    data = request.json
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞
    if not edge_validator.check_unique(data['_from'], data['_to']):
        return error("–î—É–±–ª–∏–∫–∞—Ç")
    
    # –°–æ–∑–¥–∞–Ω–∏–µ
    result = db.collection('edges').insert(data)
    return success(result)

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1 –ø—Ä–æ–≤–µ—Ä–∫–∞ + 1 –≤—Å—Ç–∞–≤–∫–∞ = 2 –æ–ø–µ—Ä–∞—Ü–∏–∏
# –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å: –í—Å–µ –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
# –ö–æ–¥: ~10 —Å—Ç—Ä–æ–∫
```

### –° —Ç–∞–±–ª–∏—Ü–µ–π-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–º:

```python
# –ú–µ—Ç–æ–¥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
@app.route('/api/edges', methods=['POST'])
def request_edge():
    data = request.json
    
    # –í—Å—Ç–∞–≤–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü—É-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫
    try:
        db.execute("INSERT INTO edge_requests ...")  # –¢—Ä–∏–≥–≥–µ—Ä –ø—Ä–æ–≤–µ—Ä–∏—Ç
    except:
        return error("–î—É–±–ª–∏–∫–∞—Ç")
    
    return success("–ó–∞–ø—Ä–æ—Å –ø—Ä–∏–Ω—è—Ç")

# –ú–µ—Ç–æ–¥ 2: –§–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
def process_edge_requests():
    while True:
        requests = db.execute("SELECT * FROM edge_requests WHERE NOT processed")
        for req in requests:
            try:
                # Cypher CREATE
                db.cypher(f"CREATE ...")
                db.execute(f"UPDATE edge_requests SET processed=TRUE WHERE id={req.id}")
            except:
                db.execute(f"UPDATE edge_requests SET error=... WHERE id={req.id}")
        sleep(1)

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1 –≤—Å—Ç–∞–≤–∫–∞ + –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π SELECT + Cypher CREATE + UPDATE = 4+ –æ–ø–µ—Ä–∞—Ü–∏–π
# –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å: –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
# –ö–æ–¥: ~50+ —Å—Ç—Ä–æ–∫ + —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å
```

---

## üéØ **–ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê –ü–û–î–•–û–î–ê:**

### **–û—Ü–µ–Ω–∫–∞ —Ä–µ–∞–ª–∏–∑—É–µ–º–æ—Å—Ç–∏:**

| –ê—Å–ø–µ–∫—Ç | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|--------|-------------|
| –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å | ‚≠ê‚≠ê‚≠ê –í–æ–∑–º–æ–∂–Ω–æ | –¢—Ä–µ–±—É–µ—Ç –∫–æ—Å—Ç—ã–ª–µ–π |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ | ‚≠ê –í—ã—Å–æ–∫–∞—è | –ú–Ω–æ–≥–æ –¥–≤–∏–∂—É—â–∏—Ö—Å—è —á–∞—Å—Ç–µ–π |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | ‚≠ê‚≠ê –ù–∏–∑–∫–∞—è | –î–≤–æ–π–Ω–∞—è –∑–∞–ø–∏—Å—å + –æ—á–µ—Ä–µ–¥—å |
| –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è | –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π |
| –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å | ‚≠ê –°–ª–æ–∂–Ω–∞—è | –ú–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ –ª–æ–≥–∏–∫–∏ |

### **–û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å "–ù–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ –º–æ–∂–µ—Ç –ø–æ–¥–æ–π—Ç–∏?"**

‚ö†Ô∏è **–ü–û–î–•–û–î–ò–¢ –ü–õ–û–•–û** - –ø–æ–¥—Ö–æ–¥ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–µ–Ω, –Ω–æ –∏–º–µ–µ—Ç –±–æ–ª—å—à–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–≤, —á–µ–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤.

---

## üìã –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ "–ó–∞" –∏ "–ü—Ä–æ—Ç–∏–≤"

### ‚úÖ **–ó–ê —Ç–∞–±–ª–∏—Ü—É-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫:**

1. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ –ë–î**
   - –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Ç—Ä–∏–≥–≥–µ—Ä–∞—Ö
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —ç—Ç—É —Ç–∞–±–ª–∏—Ü—É)

2. **–ò—Å—Ç–æ—Ä–∏—è –∏ –∞—É–¥–∏—Ç**
   - –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤—è–∑–µ–π –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
   - –ú–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–ª

3. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞)
   - –ú–æ–∂–Ω–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ä—ë–±–µ—Ä
   - –ë–∞—Ç—á–∏–Ω–≥ –æ–ø–µ—Ä–∞—Ü–∏–π

### ‚ùå **–ü–†–û–¢–ò–í —Ç–∞–±–ª–∏—Ü—ã-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫–∞:**

1. **Cypher –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ —Ç—Ä–∏–≥–≥–µ—Ä–∞**
   - PL/pgSQL –Ω–µ –º–æ–∂–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–∑–≤–∞—Ç—å `cypher()`
   - –ù—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –æ—á–µ—Ä–µ–¥–∏

2. **–î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å**
   ```
   –≠—Ç–∞–ø 1: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí edge_requests (—Å —Ç—Ä–∏–≥–≥–µ—Ä–æ–º)
   –≠—Ç–∞–ø 2: –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä ‚Üí Cypher CREATE ‚Üí –≥—Ä–∞—Ñ
   ```
   –≠—Ç–æ **—Å–ª–æ–∂–Ω–µ–µ**, —á–µ–º –ø—Ä—è–º–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è!

3. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**
   - –î–∞–Ω–Ω—ã–µ –≤ edge_requests
   - –î–∞–Ω–Ω—ã–µ –≤ –≥—Ä–∞—Ñ–µ
   - –ù—É–∂–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

4. **–ü—Ä–æ–±–ª–µ–º—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏**
   - –ï—Å–ª–∏ Cypher —É–ø–∞–¥–µ—Ç, –∑–∞–ø—Ä–æ—Å –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ edge_requests
   - –ù—É–∂–µ–Ω retry –º–µ—Ö–∞–Ω–∏–∑–º
   - –°–ª–æ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   ```
   –¢–µ–∫—É—â–µ–µ:     1 –ø—Ä–æ–≤–µ—Ä–∫–∞ + 1 —Å–æ–∑–¥–∞–Ω–∏–µ = 2 –æ–ø–µ—Ä–∞—Ü–∏–∏
   –° –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–º: 1 –≤—Å—Ç–∞–≤–∫–∞ + 1 —Ç—Ä–∏–≥–≥–µ—Ä + 1 —á—Ç–µ–Ω–∏–µ + 1 Cypher + 1 UPDATE = 5 –æ–ø–µ—Ä–∞—Ü–∏–π
   ```

6. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞**
   ```
   –¢–µ–∫—É—â–µ–µ:     ~10 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
   –° –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–º: ~50+ —Å—Ç—Ä–æ–∫ + —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å + –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   ```

---

## üîç –ü–æ—á–µ–º—É —ç—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ

### **–ö–ª—é—á–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**

Apache AGE —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω —Ç–∞–∫, —á—Ç–æ:
- **Cypher - —ç—Ç–æ entry point** –¥–ª—è –≥—Ä–∞—Ñ–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã AGE** - —ç—Ç–æ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ü—Ä—è–º–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏** –æ–±—Ö–æ–¥–∏—Ç –ª–æ–≥–∏–∫—É AGE –∏ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –≥—Ä–∞—Ñ

### **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ Cypher CREATE:**

```
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: cypher("CREATE (a)-[r]->(b)")
           ‚Üì
AGE: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ C —Ñ—É–Ω–∫—Ü–∏–∏
     ‚îú‚îÄ‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID –¥–ª—è —Ä–µ–±—Ä–∞
     ‚îú‚îÄ‚îÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
     ‚îú‚îÄ‚îÄ –í—Å—Ç–∞–≤–∫–∞ –≤ _ag_label_edge
     ‚îî‚îÄ‚îÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
           ‚Üì
–¢–∞–±–ª–∏—Ü–∞: _ag_label_edge
         (—Ç—Ä–∏–≥–≥–µ—Ä—ã –ù–ï –≤—ã–∑—ã–≤–∞—é—Ç—Å—è!)
```

### **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ INSERT —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫:**

```
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: INSERT INTO edge_requests(...)
           ‚Üì
PostgreSQL: –¢—Ä–∏–≥–≥–µ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ
           ‚Üì
–¢—Ä–∏–≥–≥–µ—Ä: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ ‚úÖ
         –ü–æ–ø—ã—Ç–∫–∞ –≤—ã–∑–≤–∞—Ç—å cypher() ‚ùå
           ‚Üì
–ü—Ä–æ–±–ª–µ–º–∞: Cypher –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ —Ç—Ä–∏–≥–≥–µ—Ä–∞!
```

---

## üéØ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

### **–í–∞—Ä–∏–∞–Ω—Ç A: –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏** ‚≠ê **–¢–ï–ö–£–©–ï–ï (–õ–£–ß–®–ï–ï)**

```python
def create_edge(from_id, to_id):
    if not check_unique(from_id, to_id):
        raise DuplicateError()
    return db.create_edge(from_id, to_id)
```

**–ü–ª—é—Å—ã:** –ü—Ä–æ—Å—Ç–æ—Ç–∞, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
**–ú–∏–Ω—É—Å—ã:** –õ–æ–≥–∏–∫–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ (–Ω–µ –≤ –ë–î)

### **–í–∞—Ä–∏–∞–Ω—Ç B: –¢–∞–±–ª–∏—Ü–∞-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫ + —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä**

```python
# API endpoint
def request_edge(from_id, to_id):
    db.insert("edge_requests", ...)  # –¢—Ä–∏–≥–≥–µ—Ä –ø—Ä–æ–≤–µ—Ä–∏—Ç
    return "Queued"

# –§–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å
while True:
    for request in get_pending_requests():
        cypher_create(request)
        mark_processed(request)
```

**–ü–ª—é—Å—ã:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –≤ –ë–î, –∞—É–¥–∏—Ç  
**–ú–∏–Ω—É—Å—ã:** –°–ª–æ–∂–Ω–æ—Å—Ç—å, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### **–í–∞—Ä–∏–∞–Ω—Ç C: Constraint + –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

```python
# –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π constraint –≤ PostgreSQL
ALTER TABLE proxy_test._ag_label_edge 
ADD CONSTRAINT unique_edges_forward 
UNIQUE (start_id, end_id);

# –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
try:
    cypher_create_edge(from, to)
except UniqueViolation:
    return error("–î—É–±–ª–∏–∫–∞—Ç")
```

**–ü—Ä–æ–±–ª–µ–º–∞:** Constraint —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –ü–†–Ø–ú–´–• –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (A‚ÜíB + A‚ÜíB), –Ω–µ –¥–ª—è –æ–±—Ä–∞—Ç–Ω—ã—Ö (A‚ÜíB + B‚ÜíA)

### **–í–∞—Ä–∏–∞–Ω—Ç D: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π constraint**

PostgreSQL –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç constraint —Ç–∏–ø–∞ "A‚ÜíB OR B‚ÜíA —É–Ω–∏–∫–∞–ª—å–Ω–∞" –Ω–∞—Ç–∏–≤–Ω–æ.

–ú–æ–∂–Ω–æ —á–µ—Ä–µ–∑:
```sql
CREATE UNIQUE INDEX unique_edges ON _ag_label_edge 
(LEAST(start_id, end_id), GREATEST(start_id, end_id));
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –≥—Ä–∞—Ñ –ù–ï–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º! –ü–æ—Ç–µ—Ä—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏.

---

## üìä –ò—Ç–æ–≥–æ–≤–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–¥—Ö–æ–¥–æ–≤

| –ü–æ–¥—Ö–æ–¥ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | –†–∞–±–æ—Ç–∞–µ—Ç? |
|--------|-----------|-------------------|------------|-----------|
| **App Validation (—Ç–µ–∫—É—â–µ–µ)** | ‚≠ê –ü—Ä–æ—Å—Ç–∞—è | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚úÖ 100% |
| **–¢–∞–±–ª–∏—Ü–∞ + —Ç—Ä–∏–≥–≥–µ—Ä + Cypher** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê | ‚≠ê‚≠ê | ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç |
| **–¢–∞–±–ª–∏—Ü–∞ + —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä** | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚úÖ –ù–æ —Å–ª–æ–∂–Ω–æ |
| **Constraint (–ø—Ä—è–º–æ–π)** | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ A‚ÜíB+A‚ÜíB |
| **Constraint (LEAST/GREATEST)** | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚ùå –ì—Ä–∞—Ñ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º |

---

## üí° **–§–ò–ù–ê–õ–¨–ù–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**

### **–ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫**

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

1. ‚ùå **–ù–µ –¥–∞–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤** - —Ç—Ä–∏–≥–≥–µ—Ä—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞—Ç—å —Ä–µ–±—Ä–æ –≤ –≥—Ä–∞—Ñ–µ
2. ‚ùå **–£—Å–ª–æ–∂–Ω—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** - –¥–æ–±–∞–≤–ª—è–µ—Ç –ª–∏—à–Ω–∏–π —Å–ª–æ–π
3. ‚ùå **–°–Ω–∏–∂–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –¥–≤–æ–π–Ω–∞—è –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö
4. ‚ùå **–°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π** - edge_requests vs —Ä–µ–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ
5. ‚ùå **–°–ª–æ–∂–Ω–µ–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ** - –±–æ–ª—å—à–µ –∫–æ–¥–∞, –±–æ–ª—å—à–µ –±–∞–≥–æ–≤
6. ‚úÖ **–¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ—â–µ –∏ –ª—É—á—à–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 100%

### **–û—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ:**

‚úÖ **ArangoDB Community + –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏**

**–ü–æ—á–µ–º—É —ç—Ç–æ –ª—É—á—à–µ:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ - 10 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ vs 50+
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å - 2 –æ–ø–µ—Ä–∞—Ü–∏–∏ vs 5+
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å - –æ–¥–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è vs —Å–ª–æ–∂–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å - –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥
- ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 100%** - –≤—Å–µ 7 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω—ã

---

## üìö –ö–æ–≥–¥–∞ —Ç–∞–±–ª–∏—Ü–∞-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –ò–ú–ï–ï–¢ –°–ú–´–°–õ

### **–ü–æ–ª–µ–∑–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:**

1. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:**
   - –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
   - –ù—É–∂–Ω–æ –æ—Ç–¥–∞–≤–∞—Ç—å –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –±—ã—Å—Ç—Ä–æ
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ —Ñ–æ–Ω–µ

2. **–ë–∞—Ç—á–∏–Ω–≥ –æ–ø–µ—Ä–∞—Ü–∏–π:**
   - –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

3. **–ê—É–¥–∏—Ç –∏ –∏—Å—Ç–æ—Ä–∏—è:**
   - –ù—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –í–°–ï –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è
   - –í–∫–ª—é—á–∞—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ
   - –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏

4. **–°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–±—É—é—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
   - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
   - –ù—É–∂–Ω–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è

### **–ù–ï –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞ –¥–ª—è:**

- ‚ùå –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ (—Ç–µ–∫—É—â–∏–π —Å–ª—É—á–∞–π)
- ‚ùå –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚ùå –ö–æ–≥–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –±—ã—Å—Ç—Ä–∞—è

---

## ‚úÖ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

### **–û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å:**

**–ü–æ–¥—Ö–æ–¥ —Å —Ç–∞–±–ª–∏—Ü–µ–π-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–µ–Ω, –ù–û:**

‚ùå **–ù–ï –ü–û–î–•–û–î–ò–¢** –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, –ø–æ—Ç–æ–º—É —á—Ç–æ:
- –¢—Ä–∏–≥–≥–µ—Ä—ã –Ω–µ –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å Cypher –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä—ë–±–µ—Ä
- –¢—Ä–µ–±—É–µ—Ç —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ ‚Üí **—Å–ª–æ–∂–Ω–µ–µ, —á–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏**
- –°–Ω–∏–∂–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –£—Å–ª–æ–∂–Ω—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- –ù–µ –¥–∞–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –ø–µ—Ä–µ–¥ —Ç–µ–∫—É—â–∏–º —Ä–µ—à–µ–Ω–∏–µ–º

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

‚≠ê **–û–°–¢–ê–í–ò–¢–¨ —Ç–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ –∏ –Ω–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ!

---

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ:** 17 –æ–∫—Ç—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä:** Claude (Cursor AI) + –ê–ª–µ–∫—Å–∞–Ω–¥—Ä  
**–°—Ç–∞—Ç—É—Å:** –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–∞–Ω–∞

