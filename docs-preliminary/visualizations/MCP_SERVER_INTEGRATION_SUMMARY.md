# –†–µ–∑—é–º–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ MCP —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è Graph Viewer

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ MCP (Model Context Protocol) —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–æ–≤ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π ArangoDB, SSH —Ç—É–Ω–Ω–µ–ª–µ–π –∏ –ø—Ä–æ—Ü–µ—Å—Å-–º–µ–Ω–µ–¥–∂–µ—Ä–∞.

## üìä –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:
- **MCP —Å–µ—Ä–≤–µ—Ä**: `src/mcp_server/server.py` –≤–µ—Ä—Å–∏—è 1.0.0
- **7 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**: —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è Graph Viewer
- **–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: ArangoDB + SSH + Process Manager
- **–ó–µ–ª–µ–Ω–∞—è —Ç–æ—á–∫–∞**: —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ Cursor
- **–ß–∏—Å—Ç—ã–π –∫–æ–¥**: —É–¥–∞–ª–µ–Ω—ã –≤—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### üîß –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
1. **Graph Viewer**: `open_graph_viewer`, `graph_viewer_status`, `stop_graph_viewer`
2. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: `check_imports`, `check_stubs`
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: `test_arango`, `test_ssh`

### üìä –°—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- **üóÑÔ∏è ArangoDB**: `connected` - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `fedoc` –¥–æ—Å—Ç—É–ø–Ω–∞
- **üîå SSH —Ç—É–Ω–Ω–µ–ª—å**: `connected` (PID: 2334) - `localhost:8529 ‚Üí vuege-server:8529`
- **üöÄ API —Å–µ—Ä–≤–µ—Ä**: `running` (PID: 15470) - –ø–æ—Ä—Ç 8899
- **‚ö° Vite —Å–µ—Ä–≤–µ—Ä**: `running` (PID: 15485) - –ø–æ—Ä—Ç 5173

## üöÄ –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –≠—Ç–∞–ø 1: –ü—Ä–æ—Å—Ç–æ–π MCP —Å–µ—Ä–≤–µ—Ä-—ç–º—É–ª—è—Ç–æ—Ä
- **–¶–µ–ª—å**: –î–æ–±–∏—Ç—å—Å—è "–∑–µ–ª–µ–Ω–æ–π —Ç–æ—á–∫–∏" –≤ Cursor
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –°–æ–∑–¥–∞–Ω `simple_server.py` —Å –±–∞–∑–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
- **–ü—Ä–æ–±–ª–µ–º—ã**: –ü—É—Å—Ç—ã–µ `capabilities.tools` –≤ `initialize` ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º `logging`

### –≠—Ç–∞–ø 2: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ
- **–®–∞–≥ 1**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`expanded_server.py`)
- **–®–∞–≥ 2**: –í–≤–µ–¥–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ `MCPServer` (`step2_class_server.py`)
- **–®–∞–≥ 3**: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (`step3_handlers_server.py`)
- **–®–∞–≥ 4**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`step4_config_server.py`)
- **–®–∞–≥ 5**: Graph Viewer –∑–∞–≥–ª—É—à–∫–∏ (`step5_graph_server.py`)

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **–®–∞–≥ 1**: –ê–Ω–∞–ª–∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ (`hybrid_server.py`)
- **–®–∞–≥ 2**: –ü—Ä–æ—Å—Ç—ã–µ –∏–º–ø–æ—Ä—Ç—ã (`imports_server.py`)
- **–®–∞–≥ 3**: –£–º–Ω—ã–µ –∑–∞–≥–ª—É—à–∫–∏ (`stubs_server.py`)

### –≠—Ç–∞–ø 4: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∑–∞–≥–ª—É—à–µ–∫
- **–®–∞–≥ 4.1**: ArangoDB –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (`arango_server.py`)
- **–®–∞–≥ 4.2**: SSH —Ç—É–Ω–Ω–µ–ª–∏ (`ssh_server.py`)
- **–®–∞–≥ 4.3**: Process Manager (`full_server.py`)

### –≠—Ç–∞–ø 5: –û—á–∏—Å—Ç–∫–∞ –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- **–£–¥–∞–ª–µ–Ω–∏–µ**: 15 –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–°–æ–∑–¥–∞–Ω–∏–µ**: –§–∏–Ω–∞–ª—å–Ω—ã–π `server.py` —Å 7 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MCP

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞:
```python
class FedocMCPServer:
    def __init__(self):
        self.arango_connection = self._init_arango()
        self.ssh_tunnel = self._init_ssh_tunnel()
        self.process_manager = self._init_process_manager()
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- **ArangoDB**: –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `python-arango`
- **SSH —Ç—É–Ω–Ω–µ–ª–∏**: `TunnelManager` –∏–∑ `lib.graph_viewer.backend`
- **Process Manager**: `ProcessManager` –¥–ª—è API –∏ Vite —Å–µ—Ä–≤–µ—Ä–æ–≤

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MCP:
```json
{
  "fedoc": {
    "command": "/home/alex/fedoc/venv/bin/python",
    "args": ["/home/alex/fedoc/src/mcp_server/server.py"],
    "env": {
      "PYTHONPATH": "/home/alex/fedoc/src",
      "ARANGO_PASSWORD": "fedoc_dev_2025",
      "MCP_SERVER_NAME": "fedoc"
    }
  }
}
```

## üêõ –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. JSON-RPC –ø—Ä–æ—Ç–æ–∫–æ–ª
- **–ü—Ä–æ–±–ª–µ–º–∞**: `print()` –Ω–∞—Ä—É—à–∞–ª JSON-RPC 2.0
- **–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ `sys.stderr` —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é `log()`

### 2. MCP –ø—Ä–æ—Ç–æ–∫–æ–ª
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `notifications/initialized`
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ `initialize`

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Cursor
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ `mcp.json` —Ñ–∞–π–ª—ã
- **–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### 4. –ò–º–ø–æ—Ä—Ç—ã –º–æ–¥—É–ª–µ–π
- **–ü—Ä–æ–±–ª–µ–º–∞**: `TunnelManager` –∏ `ProcessManager` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `PYTHONPATH`

## üìÅ –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
src/mcp_server/
‚îú‚îÄ‚îÄ server.py              # –§–∏–Ω–∞–ª—å–Ω—ã–π MCP —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ config.py             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ mcp_protocol.py       # MCP –ø—Ä–æ—Ç–æ–∫–æ–ª
‚îú‚îÄ‚îÄ handlers/             # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ requirements.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π MCP —Å–µ—Ä–≤–µ—Ä** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Graph Viewer —Å:
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–º ArangoDB –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
- ‚úÖ SSH —Ç—É–Ω–Ω–µ–ª—è–º–∏ –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ API –∏ Vite
- ‚úÖ 7 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π –≤ Cursor (–∑–µ–ª–µ–Ω–∞—è —Ç–æ—á–∫–∞)

**Graph Viewer –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ
